# Реферальная система на Django

Это простая реферальная система с использованием Django и Django REST Framework (DRF). Проект реализует API для авторизации пользователей по номеру телефона, создание и активацию инвайт-кодов, а также профили пользователей с возможностью видеть список пользователей, которые ввели их инвайт-код.

## Стек технологий
- Python 3.12
- Django 5.1
- Django REST Framework (DRF)
- PostgreSQL
- Docker (для простоты запуска проекта)

## Установка и настройка

### 1. Клонирование репозитория
Для начала клонируйте репозиторий на вашу машину:
```bash
git clone https://github.com/yourusername/referral_system.git
cd referral_system
```

### 2. Создание виртуального окружения (опционально)
Рекомендуется создать виртуальное окружение для проекта:
```bash
python -m venv .venv
source .venv/bin/activate  # Для Linux/macOS
.venv\Scripts\activate  # Для Windows
```

### 3. Установка зависимостей
Установите все необходимые зависимости:
```bash
pip install -r requirements.txt
```

### 4. Настройка базы данных
Проект использует PostgreSQL. Перед запуском проекта необходимо настроить базу данных. Убедитесь, что у вас установлен PostgreSQL и выполнены следующие шаги:

- Создайте базу данных PostgreSQL:
```bash
psql -U postgres
CREATE DATABASE referral_system;
```

- Установите настройки для подключения к базе данных в `settings.py`:
```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'referral_system',
        'USER': 'postgres',
        'PASSWORD': 'yourpassword',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```

### 5. Миграции базы данных
Примените миграции для создания всех таблиц в базе данных:
```bash
python manage.py makemigrations
python manage.py migrate
```

### 6. Создание суперпользователя
Для того чтобы работать с админкой Django, создайте суперпользователя:
```bash
python manage.py createsuperuser
```

### 7. Запуск сервера
Теперь вы можете запустить сервер разработки:
```bash
python manage.py runserver
```

### 8. Документация API (ReDoc)
Проект включает документацию API с помощью ReDoc и Swagger. После запуска сервера документация будет доступна по следующему адресу:
```
http://localhost:8000/redoc/
http://localhost:8000/swagger/
```

## Использование Docker

### 1. Установка Docker
Убедитесь, что Docker установлен на вашей машине. Если нет, следуйте [инструкциям по установке Docker](https://docs.docker.com/get-docker/).

### 2. Запуск проекта с помощью Docker
Для запуска проекта в контейнере Docker выполните следующие шаги:

1. Создайте файл `.env` в корне проекта и добавьте настройки для подключения к базе данных PostgreSQL:
    ```
    POSTGRES_USER=postgres
    POSTGRES_PASSWORD=yourpassword
    POSTGRES_DB=referral_system
    ```

2. Построение и запуск контейнеров:
    ```bash
    docker-compose up --build
    ```

3. Откройте приложение в браузере по адресу:
    ```
    http://127.0.0.1:8000
    ```

4. Для остановки контейнеров используйте команду:
    ```bash
    docker-compose down
    ```

## API

### 1. Авторизация или регистрация
#### Запрос:
POST `/phone/`
- Данные: `{ "phone_number": "ваш_номер_телефона" }`

Ответ:
- Код успешного ответа: `200 OK`
- Ответ:
  ```json
  {
    "message": "Пользователь создан, код верификации отправлен на номер телефона."
  }
  ```
  
### 2. Верификация пользователя
#### Запрос:
POST `/verify/`
- Данные: `{ "phone_number": "ваш_номер_телефона", "verification_code": "код_из_смс" }`

Ответ:
- Код успешного ответа: `200 OK`
- Ответ:
  ```json
  {
    "message": "Верификация прошла успешно! Ваш invite-код: "
  }
  ```

### 3. Просмотр профиля пользователя
#### Запрос:
GET `/profile/{username}`
- Данные: username

Ответ:
- Код успешного ответа: `200 OK`
- Ответ:
  ```json
  {
    "phone_number": "ваш_номер_телефона",
    "invite_code": "ABC123",
    "referred_by": null,
    "activated_invite_code": null,
    "referrals": ["1234567890", "9876543210"]
  }
  ```

### 4. Активация инвайт-кода
#### Запрос:
POST `/profile/{username}/activate-invite-code/`
- Данные: username
```json
{ 
    "phone_number": "username", 
    "verification_code": "код_из_смс" 
}
```

Ответ:
- Код успешного ответа: `200 OK`
- Ответ:
  ```json
  {
    "message": "Инвайт-код OgFFHe успешно активирован!"
  }
  ```

## Заключение
Этот проект предоставляет базовую функциональность для реферальной системы, где пользователи могут авторизоваться по номеру телефона, создавать и активировать инвайт-коды, а также просматривать информацию о своих рефералах. Проект легко развивать и адаптировать под ваши нужды.

Не забывайте про создание суперпользователя для доступа к административной панели и про использование Docker для упрощения запуска проекта!

```